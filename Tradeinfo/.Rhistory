grep(pattern = "[:num:]",x = d)
?grep
?regexpr
?regexp
grep(pattern = "[:digit:]",x = d)
d
grep(pattern = "[:digit:]",x = d[1])
grep("[a-z]", letters)
substr(d,start = 0,stop = 2)
substr(d,start = 1,stop = 3)
d1<-substr(d,start = 1,stop = 3)
d1<-substring(d1, seq(1,nchar(d1),1), seq(1,nchar(d1),1))
d1<-substring(d1, seq(1,nchar(d1[1]),1), seq(1,nchar(d1[1]),1))
d1
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
d1<-substr(d,start = 1,stop = 3)
d1
seq(1,nchar(d1[1]),1)
seq(1,nchar(d1[1]),1)
treat <- "OABCOABOACOBC"
treat<-substring(treat, seq(1,nchar(treat),1), seq(1,nchar(treat),1))
treat
seq(1,nchar(treat),1)
treat <- "OABCOABOACOBC"
seq(1,nchar(treat),1)
seq(1,nchar(treat),1)
substr("123",1,1)
substr("123",1,2)
substr("123",c(1,2),c(1,2))
treat
substring("123",c(1,2),c(1,2))
d1
substring(d1, seq(1,nchar(d1[1]),1), seq(1,nchar(d1[1]),1))
substring(d1[1], seq(1,nchar(d1[1]),1), seq(1,nchar(d1[1]),1))
substring(d1[2], seq(1,nchar(d1[1]),1), seq(1,nchar(d1[1]),1))
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
d1<-substr(d,start = 1,stop = 3)
d1
d1<-paste(d1,collapse = "")
d1
d1<-substring(d1, seq(1,nchar(d1),1), seq(1,nchar(d1),1))
d1
d
d1<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
d2
d1<-paste(d1,collapse = "");d2<-paste(d2,collapse = "")
d2<-substring(d2, seq(1,nchar(d2),1), seq(1,nchar(d2),1))
d2
d2<-as.numeric(d2)
blk <-gl(10,1,80,labels = c(paste("W",1:5),paste("M",1:5)))
blk
blk <-gl(10,1,80,labels = c(paste("W",1:5,sep = ""),paste("M",1:5,sep = "")))
blk
d2
d1
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
d1<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
d1<-paste(d1,collapse = "");d2<-paste(d2,collapse = "")
d1<-substring(d1, seq(1,nchar(d1),1), seq(1,nchar(d1),1))
dq
d1
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
d1<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
d1<-paste(d1,collapse = "");d2<-paste(d2,collapse = "")
d1
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
d1<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
d1
d1
y<-as.numeric(d2)
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
factors<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
#d1<-paste(d1,collapse = "")
d2<-paste(d2,collapse = "")
#d1<-substring(d1, seq(1,nchar(d1),1), seq(1,nchar(d1),1))
d2<-substring(d2, seq(1,nchar(d2),1), seq(1,nchar(d2),1))
y<-as.numeric(d2)
blk <-gl(10,1,80,labels = c(paste("W",1:5,sep = ""),paste("M",1:5,sep = "")))
aov(y~blk+factors)
factors
factors <- gl(8,10,80, labels = factors)
aov(y~blk+factors)
aov(y~blk+(factors)^2)
m<-aov(y~blk+factors)
summary(m)
factors
expand.grid(Factor1 = c("Low", "High"), Factor2 = c("Low", "High"),
Factor3 = c("Low", "High"))
factors<-expand.grid(Ball = c("Low", "High"), Position = c("Low", "High"),
Jump = c("Low", "High"))
factors
factors<-expand.grid(Ball = c("-", "+"), Position = c("-", "+"),
Jump = c("-", "+"))
factors
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
factors<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
factors
factors <- gl(8,10,80, labels = factors)
factors
factors<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
factors <- rep(factors,10)
factors
?replications
?rep
factors <- rep(factors,each=10)
factors
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
factors<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
factors <- rep(factors,each=10)
factors
factors <- rep(factors,each=10);factors <- paste(factors,collapse = "")
factors
d<-"−−−0010010021 +−−0000012011 −+−2111212230 ++−1201110310 −−+0001211000 +−+1101100101 −++2110121120 +++0021221110"
d<-unlist(strsplit(d,split = " "))
factors<-substr(d,start = 1,stop = 3);d2<-substr(d,start = 4,stop = nchar(d[1]))
factors <- rep(factors,each=10);factors <- paste(factors,collapse = "")
factors
factors <-substring(factors, seq(1,nchar(factors),1), seq(1,nchar(factors),1))
factors
factors <- matrix(factors,8,10,byrow = T)
factors
tm1 = gl(k1, 1, n*k1*k2*k3, factor(f1))
tm2 = gl(k2, n*k1, n*k1*k2*k3, factor(f2))
f1 = c("-","+") # 1st factor levels
f2 = c("-","+")            # 2nd factor levels
f3 = c("-","+")
k1 = length(f1)          # number of 1st factors
k2 = length(f2)          # number of 2nd factors
k3 = length(f3)
n = 10                    # observations per treatment
tm1 = gl(k1, 1, n*k1*k2*k3, factor(f1))
tm2 = gl(k2, n*k1, n*k1*k2*k3, factor(f2))
tm3 = gl(k3, n*k1, n*k1*k2*k3, factor(f3))
tm1
tm2
tm3
tm1 = gl(k1, 10, n*k1*k2*k3, factor(f1))
tm1
tm2 = gl(k2, 20, n*k1*k2*k3, factor(f2))
tm2
tm3 = gl(k3, 40, n*k1*k2*k3, factor(f3))
tm3
Ball = gl(k1, 10, n*k1*k2*k3, factor(f1))
Position = gl(k2, 20, n*k1*k2*k3, factor(f2))
Jump = gl(k3, 40, n*k1*k2*k3, factor(f3))
d2<-paste(d2,collapse = "")
#d1<-substring(d1, seq(1,nchar(d1),1), seq(1,nchar(d1),1))
d2<-substring(d2, seq(1,nchar(d2),1), seq(1,nchar(d2),1))
y<-as.numeric(d2)
blk <-gl(10,1,80,labels = c(paste("W",1:5,sep = ""),paste("M",1:5,sep = "")))
m<-aov(y~blk+Ball*Position*Jump)
summary(m)
as.data.frame(Ball,Position,Jump)
Ball
Position
d2<-paste(d2,collapse = "")
d2<-substring(d2, seq(1,nchar(d2),1), seq(1,nchar(d2),1))
y<-as.numeric(d2)
blk <-gl(10,1,80,labels = c(paste("W",1:5,sep = ""),paste("M",1:5,sep = "")))
m<-aov(y~blk+Ball*Position*Jump)
summary(m)
m
summary(m)
summary(m,mode = "mean")
summary(m,mode = "effect")
m<-aov(y~blk+Ball*Position*Jump,mode="mean")
y <- paste(y,collapse = "")
y
y <-"80 (3) 65 (4) 69 (7) 74 (2) 81 (9) 84 (1) 91 (5) 93 (8)
62 (15) 63 (12) 73 (13) 80 (16) 79 (10) 86 (6) 93 (14) 93 (11)"
y <- paste(y,collapse = "")
y
y <- paste(y,collapse = "")
y
y <-"80 (3) 65 (4) 69 (7) 74 (2) 81 (9) 84 (1) 91 (5) 93 (8)
62 (15) 63 (12) 73 (13) 80 (16) 79 (10) 86 (6) 93 (14) 93 (11)"
y <- strsplit(y,split = " ")
y
y <- paste(y,collapse = "")
y
y <-"80 (3) 65 (4) 69 (7) 74 (2) 81 (9) 84 (1) 91 (5) 93 (8)
62 (15) 63 (12) 73 (13) 80 (16) 79 (10) 86 (6) 93 (14) 93 (11)"
y <- unlist(strsplit(y,split = " "))
y <- paste(y,collapse = "")
y
y <-"80 (3) 65 (4) 69 (7) 74 (2) 81 (9) 84 (1) 91 (5) 93 (8) 62 (15) 63 (12) 73 (13) 80 (16) 79 (10) 86 (6) 93 (14) 93 (11)"
y <- unlist(strsplit(y,split = " "))
y <- paste(y,collapse = "")
y
gsub("([:digit:])","",x = y)
gsub("\\([:digit:]\\)","",x = y)
gsub("\([:digit:]\)","",x = y)
gsub("\\([:digit:]\)\","",x = y)
gsub("\\([:digit:]\\)","",x = y)
y
gsub("\\(","",x = y)
grep("\\(|\\)",x = y)
y
grep("\\( | \\)",x = y)
grep("\\(|\\)",x = y)
sub("\\(|\\)","",x = y)
sub("\\)","",x = y)
?gsub
y <-"80 65 69 74 81 84 91 93 62 63 73 80 79 86 93 93"
y <- unlist(strsplit(y,split = " "))
y
y <- paste(y,collapse = "")
y
y <-"80 65 69 74 81 84 91 93 62 63 73 80 79 86 93 93"
y <- unlist(strsplit(y,split = " "))
y
y <- as.numeric(unlist(strsplit(y,split = " ")))
y
Concentration = gl(2, 2,16 , labels = c("-","+"))
Concentration
Temp = gl(2, 1,16 , labels = c("-","+"))
Concentration = gl(2, 2,16 , labels = c("-","+"))
Time = gl(2, 4, 16, labels = c("-","+"))
Time
Temp = gl(2, 1,16 , labels = c("-","+"))
Concentration = gl(2, 2,16 , labels = c("-","+"))
Time = gl(2, 4, 16, labels = c("-","+"))
y <-"80 65 69 74 81 84 91 93 62 63 73 80 79 86 93 93"
y <- as.numeric(unlist(strsplit(y,split = " ")))
m<-aov(y~Temp*Concentration*Time)
m
summary(m)
qqnorm(y)
boxplot(y)
m<-aov(y~Temp*Concentration*Time)
summary(m)
plot(resid(m))
qqnorm(y)
qqline(y, col = 2)
boxplot(y)
m<-aov(y~Temp*Concentration*Time)
model.matrix(m)
d2<-paste(d2,collapse = "")
d2<-substring(d2, seq(1,nchar(d2),1), seq(1,nchar(d2),1))
y<-as.numeric(d2)
blk <-gl(10,1,80,labels = c(paste("W",1:5,sep = ""),paste("M",1:5,sep = "")))
m<-aov(y~blk+Ball*Position*Jump)
summary(m)
m$effects
Temp = gl(2, 1,16 , labels = c("-","+"))
Concentration = gl(2, 2,16 , labels = c("-","+"))
Time = gl(2, 4, 16, labels = c("-","+"))
y <-"80 65 69 74 81 84 91 93 62 63 73 80 79 86 93 93"
y <- as.numeric(unlist(strsplit(y,split = " ")))
qqnorm(y)
qqline(y, col = 2)
boxplot(y)
### 2.2
m<-aov(y~Temp*Concentration*Time)
summary(m)
plot(resid(m))
m<-aov(y[-1]~Temp[-1]*Concentration[-1]*Time[-1])
summary(m)
plot(resid(m))
f3 = c("-","+")
source('~/Box Sync/Course/602/hwk/hwk10.R', echo=TRUE)
boxplot(y~Temp*Concentration*Time)
?biplot
require(graphics)
biplot(princomp(USArrests))
princomp(USAccDeaths)
princomp(USArrests)
USArrests
require(graphics)
biplot(princomp(USArrests))
princomp(USArrests)
a<-princomp(USArrests)
a$loadings
a$scores
a<-princomp(USArrests)
biplot(a)
a
a$loadings
a$loadings
a$scores
a$loadings
biplot(prcomp(USArrests, scale = TRUE))
a<-prcomp(USArrests, scale = TRUE)
biplot(a)
a$loadings
?biplot
a<-prcomp(USArrests, scale = TRUE)
biplot(a)
a$loadings
a$rotation
a$x
x<-prcomp(USArrests, scale=TRUE)
choices = 1L:2L
scale = 1
pc.biplot = FALSE
scores<-x$x
lam <- x$sdev[choices]
n <- NROW(scores)
lam <- lam * sqrt(n)
lam <- lam^scale
yy<-t(t(x$rotation[, choices]) * lam)
xx<-t(t(scores[, choices])/lam)
biplot(xx,yy)
y <- c(8389,816,4,46,
4351,78,5941,27138,
6,262,1230,98,
375,33551,246,10,
56034,25046,109,490,
2346,35,228,6842,
67,3081,50991,784,
40581,90293,19103,61)
y1 <- c(8389,816,4,46,
4351,78,5941,27138,
6,262,1230,98,
375,33551,246,10)
y2 <- c(56034,25046,109,490,
2346,35,228,6842,
67,3081,50991,784,
40581,90293,19103,61)
A <- c("-1","-1","1","1",
"1","1","-1","-1",
"1","1","-1","-1",
"-1","-1","1","1")
B <- c("-1","1","1","-1",
"-1","1","1","-1",
"1","-1","-1","1",
"1","-1","-1","1")
C <- c("-1","1","-1","1",
"-1","1","-1","1",
"-1","1","-1","1",
"-1","1","-1","1")
D <-  c("-1","-1","1","1",
"-1","-1","1","1",
"-1","-1","1","1",
"-1","-1","1","1")
M<-lm(y1 ~ A*B*C*D)
summary(M)
M<-lm(y1 ~ A*B*C*D - A:B)
summary(M)
M<-lm(y1 ~ A*B*C*D - A1:B1)
contr.sum()
n <- 8
y <- rep(NA,n)
x1 <- rep(c(-1,1),4)
x2 <- rep(c(-1,-1,1,1),2)
x3 <- rep(c(-1,1),c(4,4))
A <- 2
B <- 3
C <- 4
AB <- 0
BC <- 2
AC <- -2
ABC <- 1
mu <- 5
y <- mu+(A/2)*x1+(B/2)*x2+(C/2)*x3+(AB/2)*x1*x2+(AC/2)*x1*x3+(BC/2)*x2*x3+(ABC/2)*x1*x2*x3
y <- mu+(A/2)*x1+(B/2)*x2+(C/2)*x3+(AB/2)*x1*x2+(AC/2)*x1*x3+(BC/2)*x2*x3+(ABC/2)*x1*x2*x3
model1 <- lm(y ~ x1*x2*x3) # treat X as continuous variables
print(summary(model1))
x12 <- x1*x2
x13 <- x1*x3
x23 <- x2*x3
x123 <- x1*x2*x3
x1 <- as.factor(x1)
x2 <- as.factor(x2)
x3 <- as.factor(x3)
x12 <- as.factor(x12)
x13 <- as.factor(x13)
x23 <- as.factor(x23)
x123 <- as.factor(x123)
model2 <- lm(y ~ x1+x2+x3+x12+x13+x23+x123)
print(summary(model2))
source('~/Box Sync/Course/602/hwk/hwklast.R', echo=TRUE)
summary(M)
source('~/Downloads/fact.r', echo=TRUE)
source('~/Box Sync/Course/602/hwk/hwklast.R', echo=TRUE)
source('~/Box Sync/Course/602/hwk/hwklast.R', echo=TRUE)
M$coefficients
da <- c(19,32,29,13,8,12,16,20,14,17,22,18,23)
length(da)
sample(da,size = 13,replace = T)
boot <-sapply(1:1000, function(x) sample(x = da,size = 13,replace = T))
class(boot)
dim(boot)
hist(boot)
boot <-sapply(1:10000, function(x) sample(x = da,size = 13,replace = T))
hist(boot)
boot <-sapply(1:100, function(x) sample(x = da,size = 13,replace = T))
hist(boot)
boot <-sapply(1:100, function(x) sample(x = da,size = 13,replace = T))
hist(boot)
boot <-sapply(1:10000, function(x) sample(x = da,size = 13,replace = T))
hist(boot)
boot <-sapply(1:1000, function(x) sample(x = da,size = 13,replace = T))
hist(boot)
boot <-sapply(1:100, function(x) sample(x = da,size = 13,replace = T))
hist(boot)
da <- c(.28,.98,1.36,1.38,2.4,7.42)
boot <-sapply(1:100, function(x) sample(x = da,size = 13,replace = T))
dim(boot)
boot.mean <- mean(colMeans(boot))
mean(colMeans(boot))
mean(da)
apply(boot, 2, var)
var(da)
mean(colMeans(boot))
apply(boot, 2, var)
mean(apply(boot, 2, var))
law <- matrix(c(576,3.39,635,3.30,558,2.81,578,3.03,666,3.44,580,3.07,555,3,661,3.43,651,3.36,605,3.13,653,3.12,575,2.74,545,2.76,572,2.88,594,2.96),byrow = T,ncol=2)
cor(law)
n <- 15
theta <- function(x,law){ cor(law[x,1],law[x,2]) }
results <- bootstrap(1:n,1000,theta,law,func=sd)
results[2]
theta <- function(x,law){ cor(law[x,1],law[x,2]) }
results <- bootstrap(1:n,1000,theta,law,func=sd)
theta <- function(x,law){ cor(law[x,1],law[x,2])}
results <- bootstrap(1:n,1000,theta,law,func=sd)
?bootstrap
??bootstrap
law
dim(law)
boot <-sapply(1:100, function(x) {
l<-sample(x = 1:15,size = 15,replace = T)
return(law[l,])})
dim(boot)
boot <-lapply(1:100, function(x) {
l<-sample(x = 1:15,size = 15,replace = T)
return(law[l,])})
dim(boot)
l<-sample(x = 1:15,size = 15,replace = T)
l
law[l,])
law[l,]
boot <-lapply(1:2, function(x) {
l<-sample(x = 1:15,size = 15,replace = T)
return(law[l,])})
boot
boot <-lapply(1:100, function(x) {
l<-sample(x = 1:15,size = 15,replace = T)
return(law[l,])})
boot[[1]]
boot <- as.data.frame(boot)
boot
corrboot <- lapply(boot, function(x) return(cor(x)[1,2]))
q
q()
boot <-lapply(1:100, function(x) {
l<-sample(x = 1:15,size = 15,replace = T)
return(law[l,])})
corrboot <- lapply(boot, function(x) return(cor(x)[1,2]))
corrboot
sd(unlist(corrboot))
colMeans(law)
law[,1]
var(law)
cor(law)
mx<-600.3;my<-3.09
sdx<-sqrt(1746.78);sdy<-sqrt(.059)
rho<-.7764;b<-rho*sdx/sdy;sdxy<-sqrt(1-rho^2)*sdx
rhodata<-rho
for (j in 1:1000)  {
y<-rnorm(15,mean=my,sd=sdy)
x<-rnorm(15,mean=mx+b*(y-my),sd=sdxy)
rhodata<-c(rhodata,cor(x,y))
}
sd(rhodata)
hist(rhodata)
```
sqrt((1-.7764^2)^2/15)
library(XML)
library(RCurl)
library(XML)
library(RCurl)
link <- "http://www.icbc.com.cn/ICBC/%E7%BD%91%E4%B8%8A%E7%90%86%E8%B4%A2/%E4%BA%A7%E5%93%81%E9%98%B5%E7%BA%BF/default.htm"
webpage <- getURL(link)
webpage
library(lmtest)
?grangertest
install.packages('rsconnect')
install.packages("rsconnect")
install.packages("rsconnect")
install.packages("rsconnect")
rsconnect::setAccountInfo(name='ding',
token='48CD5247CA4348EE301101517285A152',
secret='<SECRET>')
rsconnect::setAccountInfo(name='ding', token='48CD5247CA4348EE301101517285A152'
, secret='laBhGpWiW2RPKAiCGOLb3zMNfDY/K3LGMpbB267H')
install.packages(c('ggplot2', 'shiny'))
getwd()
library(shiny)
runApp()
library(rsconnect)
setwd("/Users/CDX/R_workspace/portfolio_info_ShinyR/Tradeinfo")
rsconnect::setAccountInfo(name='ding', token='48CD5247CA4348EE301101517285A152'
, secret='laBhGpWiW2RPKAiCGOLb3zMNfDY/K3LGMpbB267H')
rsconnect::deployApp(account = 'ding',appName = 'Tradeinfo')
library(quantmod)
getSymbols('^SSEC')
Cl(SSEC)
library(quantmod)
getSymbols('^SSEC')
SSEC
Cl(SSEC)
last(SSEC)
